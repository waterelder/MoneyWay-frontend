"use strict";angular.module("trackRubFrontApp",["ngCookies","ngCookies","restangular","ui.router","angular-md5","ngMap","semantic-ui","ngResource","ngMask","ngSanitize","720kb.fx","LocalStorageModule"]).constant("USER_ROLES",{all:"*",admin:"ADMIN_ROLE",user:"USER_ROLE"}).config(["localStorageServiceProvider",function(a){a.setPrefix("trackRub")}]).constant("MAIN_URL","https://moneyway.xyz:8443/restrub").constant("_",window._).constant("moment",window.moment).config(["$stateProvider","$urlRouterProvider","$locationProvider","USER_ROLES",function(a,b,c,d){c.html5Mode(!0),a.state("root",{url:"","abstract":!0,views:{header:{templateUrl:"views/mainlayout/header.html",controller:"HeaderCtrl"},footer:{templateUrl:"views/mainlayout/footer.html",controller:"FooterCtrl"}},data:{authorizedRoles:[d.all]}}).state("root.main",{url:"/?isNew",views:{"container@":{templateUrl:"views/home.html"}},data:{authorizedRoles:[d.all]}}).state("root.confirm",{url:"/confirm?data",views:{"container@":{templateUrl:"views/confirm.html",controller:"ConfirmCtrl"}},data:{authorizedRoles:[d.all]}}).state("root.newcash",{url:"/newcash",views:{"container@":{templateUrl:"views/newcash.html",controller:"NewCashCtrl"}},data:{authorizedRoles:[d.all]}}).state("root.cash",{url:"/cash?id",views:{"container@":{templateUrl:"views/cash.html",controller:"CashCtrl"}},data:{authorizedRoles:[d.all]}}).state("root.register",{url:"/register",views:{"container@":{templateUrl:"views/register.html",controller:"RegisterCtrl"}},data:{authorizedRoles:[d.all]}}),b.otherwise("/")}]).run(["$rootScope",function(a){a.$on("$stateChangeStart",function(a,b){})}]),angular.module("trackRubFrontApp").factory("MapService",["$http","NgMap",function(a,b){var c={initMap:function(a,d){b.getMap(d).then(function(b){a.map=b,a.map.setOptions({zoom:8,center:{lat:55.754941,lng:37.617188},streetViewControl:!1,rotateControl:!1,mapTypeControl:!1,scrollwheel:!1}),c.setDefaultBrowserLocation(a,!0)})},setDefaultBrowserLocation:function(a,b){navigator.geolocation.getCurrentPosition(function(d){var e=new google.maps.LatLng(d.coords.latitude,d.coords.longitude);a.map.panTo(e),b&&(a.marker=c.setMarker(a))},c.setDefaultMarkerWithoutGeo(a,b))},setDefaultMarkerWithoutGeo:function(a,b){b&&(a.marker=c.setMarker(a))},setMarker:function(a){var b=new google.maps.Marker({map:a.map,draggable:!0,animation:google.maps.Animation.DROP,position:{lat:a.map.getCenter().lat(),lng:a.map.getCenter().lng()}});return c.replaceMarker(b.getPosition(),b,a),a.map.addListener("click",function(d){c.replaceMarker(d.latLng,b,a)}),b},replaceMarker:function(a,b,d){b.setPosition(a),d.map.panTo(a),c.getAddress(a).then(function(a){var b=a.data.results[0];d.lookUpCash.lat=b.geometry.location.lat,d.lookUpCash.lon=b.geometry.location.lng;var c=_.find(b.address_components,function(a){return _.include(a.types,"administrative_area_level_1")});d.lookUpCash.region=c.short_name;var e=_.find(b.address_components,function(a){return _.include(a.types,"locality")});_.isUndefined(e)||(d.lookUpCash.locality=e.short_name);var f=_.find(b.address_components,function(a){return _.include(a.types,"country")});d.lookUpCash.address=f.long_name+", "+c.short_name,_.isUndefined(e)||"СПБ"!==e.short_name&&"Москва"!==e.short_name&&(d.lookUpCash.address+=", "+e.short_name)})},getAddress:function(b){return a({method:"get",url:"https://maps.googleapis.com/maps/api/geocode/json?latlng="+b.lat()+","+b.lng()+"&sensor=false&language=ru",headers:{"Content-Type":"application/json"}})}};return c}]),angular.module("trackRubFrontApp").factory("NotificationService",function(){var a={notifyError:function(b){$("#custom-error-notification").removeClass("hidden").find("p").text(b),a.showAndHide("custom-error-notification")},notifySuccess:function(b,c){$("#custom-success-notification").removeClass("hidden").find(".header").text(b).parent().find("p").text(c),a.showAndHide("custom-success-notification")},showAndHide:function(a){var b=document.getElementById(a);b.className="show",setTimeout(function(){b.className=b.className.replace("show","")},3e3)}};return a}),angular.module("trackRubFrontApp").factory("RequestErrorHandler",["NotificationService",function(a){return function(b){a.notifyError("Ошибка выполнения запроса "+b.status+":"+b.statusText)}}]),angular.module("trackRubFrontApp").factory("LoginErrorHandler",["NotificationService",function(a){return function(b){a.notifyError("Неправильный логин/email или пароль ")}}]),angular.module("trackRubFrontApp").factory("CashResource",["$resource","MAIN_URL","RequestErrorHandler","Session",function(a,b,c,d){return function(d){return a(b+"/cash/lookup",{},{send:{url:b+"/cash/lookup/",method:"POST",isArray:!0,interceptor:{responseError:c}},add:{url:b+"/rest/cash",headers:{token:d},method:"POST",interceptor:{responseError:c}},getCashById:{url:b+"/rest/cash/search",method:"GET",params:{cashId:"@cashId"},isArray:!0,headers:{token:d},interceptor:{responseError:c}},getMyCash:{url:b+"/rest/cash/",method:"GET",isArray:!0,headers:{token:d},interceptor:{responseError:c}}})}}]),angular.module("trackRubFrontApp").factory("BanknoteResource",["$resource","MAIN_URL","RequestErrorHandler",function(a,b,c){var d=b+"/banknotes/find";return a(b+"/banknotes/",{code:"@code"},{findByType:{url:d,method:"GET",isArray:!0,interceptor:{responseError:c}}})}]),angular.module("trackRubFrontApp").factory("BanknoteTypeResource",["$resource","MAIN_URL","RequestErrorHandler",function(a,b,c){return a(b+"/banknotes/types",{},{findAll:{method:"GET",isArray:!0,interceptor:{responseError:c}}})}]),angular.module("trackRubFrontApp").factory("AuthResource",["$resource","MAIN_URL","RequestErrorHandler","LoginErrorHandler",function(a,b,c,d){return a(b+"/auth",{},{checkEmail:{url:b+"/auth/check/email",params:{p:"@p"},method:"GET",interceptor:{responseError:c}},register:{url:b+"/auth/register/",method:"POST",interceptor:{responseError:c}},resent:{url:b+"/auth/resent/",method:"POST",interceptor:{responseError:c}},login:{url:b+"/auth/login",method:"POST",interceptor:{responseError:d}},confirm:{url:b+"/auth/confirm",params:{hash:"@hash"},method:"POST"},checkLogin:{url:b+"/auth/check/login",params:{p:"@p"},method:"GET",interceptor:{responseError:c}}})}]),angular.module("trackRubFrontApp").factory("StatsResource",["$resource","MAIN_URL","RequestErrorHandler","Session",function(a,b,c,d){return function(){return a(b+"/stats/",{},{getSumm:{url:b+"/stats/summ",method:"GET",interceptor:{responseError:c}},getRecordsCount:{url:b+"/cash/count",method:"GET",interceptor:{responseError:c}},getStatsRecords:{url:b+"/stats/records",method:"GET",interceptor:{responseError:c}},getStatsUsers:{url:b+"/stats/users",method:"GET",interceptor:{responseError:c}},getStatsLocalities:{url:b+"/stats/localities",method:"GET",interceptor:{responseError:c}}})}}]),angular.module("trackRubFrontApp").service("Session",["$cookies","$state","localStorageService",function(a,b,c){return this.create=function(b,d){c.set("user",d),a.put("token",b),a.put("role",d.authorities[0])},this.destroy=function(){c.remove("user"),a.remove("token"),a.remove("role")},this.getToken=function(){return a.get("token")},this.getRole=function(){return a.get("role")},this.getMe=function(){return c.get("user")},this.isAuthenticated=function(){return!!a.get("token")},this.isAuthorized=function(b){return angular.isArray(b)||(b=[b]),this.isAuthenticated()&&-1!==b.indexOf(a.get("role"))},this.logout=function(){this.destroy(),c.remove("user"),b.go("root.main")},this}]),angular.module("trackRubFrontApp").controller("FooterCtrl",function(){}),angular.module("trackRubFrontApp").controller("HeaderCtrl",["$rootScope","$scope","$state","AuthResource","Session","md5",function(a,b,c,d,e,f){b.loginData={credintial:null,password:null},e.isAuthenticated()&&(b.user=e.getMe()),b.goToMain=function(){c.go("root.main")},b.goToRegister=function(){c.go("root.register")},b.loginModal=function(){$(".ui.modal.login").modal({onDeny:function(){return!1},onApprove:function(){return!1}}).modal("show")},b.isAuthenticated=function(){return e.isAuthenticated()},b.logout=function(){e.logout(),a.$emit("logout","")},a.$on("login",function(a,c){b.user=e.getMe()}),b.login=function(){var g=_.cloneDeep(b.loginData);g.password=f.createHash(g.password),d.login(g,function(d){e.create(d.token,d.user),b.loginData={credintial:null,password:null},a.$emit("login",d.user),$(".ui.modal").modal("hide"),c.go("root.main")})}}]),angular.module("trackRubFrontApp").controller("RegisterCtrl",["$scope","AuthResource","md5",function(a,b,c){function d(a){var b=/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/;return-1!=String(a).search(b)}a.registerData={login:"",email:"",password:""},a.sended=!1,a.accessory={repPassword:"",dontAsshole:!1},a.loginNotDirty=!0,a.checkLoginDirty=function(){a.loginNotDirty=a.registerData.username.length>=6&&/^\w+$/.test(a.registerData.username)},a.emailNotDirty=!0,a.checkEmailDirty=function(){a.emailNotDirty=d(a.registerData.email)},a.loginValid=!0,a.emailValid=!0,a.passwordValid=!0,a.passwordNotDirty=!0,a.foundUserUnconfirmed=!1,a.allOk=!1,a.checkPassDirty=function(){a.passwordNotDirty=a.registerData.password.length>=6},a.checkEmail=function(){a.registerData.email&&b.checkEmail({p:a.registerData.email},function(b){a.emailValid=!b.status})},a.checkLogin=function(){a.registerData.username&&b.checkLogin({p:a.registerData.username},function(b){a.loginValid=!b.status})},a.clickRegister=function(){var d=_.cloneDeep(a.registerData);d.password=c.createHash(d.password),b.register(d,function(b){a.sended=!0,0==b.status?a.foundUserUnconfirmed=!0:a.allOk=!0})},a.clickResend=function(){var d=_.cloneDeep(a.registerData);d.password=c.createHash(d.password),b.resent(d,function(b){a.foundUserUnconfirmed=!1,a.allOk=!0})},a.isRegisterBtnDisabled=function(){return!(a.registerData.password&&a.registerData.email&&a.accessory.repPassword&&a.registerData.username&&a.passwordNotDirty&&a.emailNotDirty&&a.loginValid&&a.emailValid&&a.passwordValid&&a.accessory.dontAsshole&&a.loginNotDirty)},a.isPasswordDismatch=function(){a.accessory.repPassword&&a.registerData.password&&(a.passwordValid=a.accessory.repPassword==a.registerData.password)}}]),angular.module("trackRubFrontApp").controller("HomeCtrl",["$scope","StatsResource","CashResource","MapService","NotificationService","BanknoteTypeResource","BanknoteResource","$state","Session","$rootScope",function(a,b,c,d,e,f,g,h,i,j){a.isAuthenticated=function(){return i.isAuthenticated()},a.isLookingUp=!1,a.lookUpCash={cashId:"",lat:null,lon:null};var k=function(){a.countOfBanknotes=null,a.summ=null,a.statsLocalities=[],a.statsUsers=[],a.statsRecords=[],b().getStatsLocalities(function(b){a.statsLocalities=b.content}),b().getStatsRecords(function(b){a.statsRecords=b.content}),b().getStatsUsers(function(b){a.statsUsers=b.content}),b().getRecordsCount(function(b){a.countOfBanknotes=b}),b().getSumm(function(b){a.summ=b})};k(),a.getTime=function(a){return moment.unix(a/1e3).format("DD.MM.YYYY")},j.$on("logout",function(){a.myCash=[]}),a.goToRegister=function(){h.go("root.register")},a.pressLookUp=function(){a.isLookedUp=!1,a.isLookingUp=a.isLookingUp?!1:!0,a.isLookingUp&&(_.isUndefined(a.map)?d.initMap(a,"lookup"):d.setDefaultBrowserLocation(a,!1))},f.findAll(function(b){g.findByType({code:b[0].code},function(b){a.banknotes=b})}),a.lookUp=function(){a.isLookingUp=!1,c().send(a.lookUpCash,function(b){a.isLookedUp=!0,a.cashArray=b})},a.moneyCount=0,a.getMyCash=function(){a.myCash=[],c(i.getToken()).getMyCash(function(b){a.myCash=b,_.forEach(a.myCash,function(b){b.banknote&&(a.moneyCount+=b.banknote.currency)})})},a.isAuthenticated()&&a.getMyCash(),a.addingModal=function(){h.go("root.newcash")},a.newCash={},a.goToCashPage=function(a){h.go("root.cash",{id:a.cashId})},j.$on("login",function(b,c){a.getMyCash()}),a.isAddable=function(){return a.lookUpCash.cashId&&a.lookUpCash.banknote},j.$on("saveComplete",function(a,b){e.notifySuccess("Успешно сохранено","")})}]),angular.module("trackRubFrontApp").controller("ConfirmCtrl",["$rootScope","$scope","$stateParams","AuthResource","Session","$state",function(a,b,c,d,e,f){b.data=c.data,b.errorConfirm=!1,d.confirm({hash:b.data},function(b){e.create(b.token,b.user),a.$emit("login",b.user),f.go("root.main",{isNew:!0})},function(a){b.errorConfirm=!0})}]),angular.module("trackRubFrontApp").controller("NewCashCtrl",["$scope","CashResource","MapService","NotificationService","BanknoteTypeResource","BanknoteResource","$state","Session","$rootScope",function(a,b,c,d,e,f,g,h,i){a.isAuthenticated=function(){return h.isAuthenticated()},a.lookUpCash={cashId:"",lat:null,lon:null,banknote:null},a.getTime=function(a){return moment.unix(a/1e3).format("DD.MM.YYYY")},a.goToMain=function(){g.go("root.main")},_.isUndefined(a.map)?c.initMap(a,"lookup"):c.setDefaultBrowserLocation(a,!1),a.banknotesLoaded=!1,e.findAll(function(b){f.findByType({code:b[0].code},function(b){a.banknotes=b,a.banknotesLoaded=!0})}),a.isAddable=function(){return a.lookUpCash.cashId&&a.lookUpCash.banknote},a.add=function(){a.lookUpCash.user=h.getMe(),b(h.getToken()).add(a.lookUpCash,function(a){i.$emit("saveComplete",a.user),g.go("root.main")})}}]),angular.module("trackRubFrontApp").controller("CashCtrl",["$scope","$stateParams","CashResource","MapService","NotificationService","BanknoteTypeResource","BanknoteResource","$state","Session","$rootScope",function(a,b,c,d,e,f,g,h,i,j){a.isAuthenticated=function(){return i.isAuthenticated()},a.getTime=function(a){return moment.unix(a/1e3).format("DD.MM.YYYY")},a.goToMain=function(){h.go("root.main")},c(i.getToken()).getCashById({cashId:b.id},function(b){a.cashArray=b}),f.findAll(function(b){g.findByType({code:b[0].code},function(b){a.banknotes=b,a.banknotesLoaded=!0})})}]),angular.module("trackRubFrontApp").run(["$templateCache",function(a){a.put("views/about.html",'<div class="row" id="content"> <div class="medium-8 columns"> <div class="blog-post"> <h3>Awesome blog post title <small>3/6/2015</small></h3> <img class="thumbnail" src="http://placehold.it/850x350"> <p>Praesent id metus massa, ut blandit odio. Proin quis tortor orci. Etiam at risus et justo dignissim congue. Donec congue lacinia dui, a porttitor lectus condimentum laoreet. Nunc eu ullamcorper orci. Quisque eget odio ac lectus vestibulum faucibus eget in metus. In pellentesque faucibus vestibulum. Nulla at nulla justo, eget luctus.</p> <div class="callout"> <ul class="menu simple"> <li><a href="#">Author: Mike Mikers</a></li> <li><a href="#">Comments: 3</a></li> </ul> </div> </div> <div class="blog-post"> <h3>Awesome blog post title <small>3/6/2015</small></h3> <img class="thumbnail" src="http://placehold.it/850x350"> <p>Praesent id metus massa, ut blandit odio. Proin quis tortor orci. Etiam at risus et justo dignissim congue. Donec congue lacinia dui, a porttitor lectus condimentum laoreet. Nunc eu ullamcorper orci. Quisque eget odio ac lectus vestibulum faucibus eget in metus. In pellentesque faucibus vestibulum. Nulla at nulla justo, eget luctus.</p> <div class="callout"> <ul class="menu simple"> <li><a href="#">Author: Mike Mikers</a></li> <li><a href="#">Comments: 3</a></li> </ul> </div> </div> <div class="blog-post"> <h3>Awesome blog post title <small>3/6/2015</small></h3> <img class="thumbnail" src="http://placehold.it/850x350"> <p>Praesent id metus massa, ut blandit odio. Proin quis tortor orci. Etiam at risus et justo dignissim congue. Donec congue lacinia dui, a porttitor lectus condimentum laoreet. Nunc eu ullamcorper orci. Quisque eget odio ac lectus vestibulum faucibus eget in metus. In pellentesque faucibus vestibulum. Nulla at nulla justo, eget luctus.</p> <div class="callout"> <ul class="menu simple"> <li><a href="#">Author: Mike Mikers</a></li> <li><a href="#">Comments: 3</a></li> </ul> </div> </div> <div class="blog-post"> <h3>Awesome blog post title <small>3/6/2015</small></h3> <img class="thumbnail" src="http://placehold.it/850x350"> <p>Praesent id metus massa, ut blandit odio. Proin quis tortor orci. Etiam at risus et justo dignissim congue. Donec congue lacinia dui, a porttitor lectus condimentum laoreet. Nunc eu ullamcorper orci. Quisque eget odio ac lectus vestibulum faucibus eget in metus. In pellentesque faucibus vestibulum. Nulla at nulla justo, eget luctus.</p> <div class="callout"> <ul class="menu simple"> <li><a href="#">Author: Mike Mikers</a></li> <li><a href="#">Comments: 3</a></li> </ul> </div> </div> </div> <div class="medium-3 columns" data-sticky-container> <div class="sticky" data-sticky data-anchor="content"> <h4>Categories</h4> <ul> <li><a href="#">Skyler</a></li> <li><a href="#">Jesse</a></li> <li><a href="#">Mike</a></li> <li><a href="#">Holly</a></li> </ul> <h4>Authors</h4> <ul> <li><a href="#">Skyler</a></li> <li><a href="#">Jesse</a></li> <li><a href="#">Mike</a></li> <li><a href="#">Holly</a></li> </ul> </div> </div> </div> <script>$(document).foundation();</script>'),a.put("views/cash.html",'<div ng-controller="CashCtrl"> <header ngfx-speed="slow" ngfx-fade-in="true" id="bg-yaroslavl" style="background-image: url(\'../images/back.44e443c6.png\')"> <div class="row"> <div class="medium-9 large-8 columns"></div> </div> </header> <div class="ui grid page" style="margin-top: 30px; margin-bottom: 30px"> <button class="ui left labeled icon button" ng-click="goToMain()"> <i class="left arrow icon"></i> Мои купюры </button> <div class="one column row"> <div class="column centered"> <h3>Купюра {{cashArray[0].cashId}}</h3> </div> </div> <div ngfx-speed="slow" ngfx-fade-in="true" class="one column row fade"> <div class="column"> <table class="ui unstackable selectable striped table"> <thead> <tr> <th>Тип банкноты</th> <th>Номер банкноты</th> <th>Дата регистрации</th> <th>Регион</th> <th>Пользователь</th> <th>Коментарий</th> </tr> </thead> <tbody> <tr ng-repeat="cash in cashArray"> <td> <div ng-bind-html="cash.banknote.label"></div> ({{cash.banknote.banknoteType.code}}) </td> <td>{{cash.cashId}}</td> <td>{{getTime(cash.datetime)}}</td> <td>{{cash.address}}</td> <td>{{cash.user?cash.user.username:""}}</td> <td>{{cash.comment}}</td> </tr> </tbody> </table> <div style="margin-left: 40px" ng-if="myCash.length == 0" class="row"> <h5>Нeт ни одной купюры</h5> </div> </div> <div class="ui two column grid"> <div ng-if="myCash.length > 0" class="two column row"> <div class="column"> <h4>Всего купюр: {{myCash.length}}</h4> </div> <div class="column"> <h4>На сумму: {{moneyCount}} руб.</h4> </div> </div> </div> </div> </div> </div>'),a.put("views/confirm.html",'<div style="margin-top: 30px; margin-bottom: 30px" class="ui grid container centered"> <div ng-if="errorConfirm" class="ui grid container"> <div> <h5>Ошибка. Что-то пошло не так</h5> </div> </div> </div>'),a.put("views/home.html",'<!-- Navigation --> <div ng-controller="HomeCtrl"> <header ngfx-speed="slow" ngfx-fade-in="true" id="bg-yaroslavl" style="background-image: url(\'../images/back.44e443c6.png\')"> <div class="row"> <div class="medium-9 large-8 columns"></div> </div> </header> <div ng-if="!isAuthenticated()"> <div ngfx-speed="slow" ngfx-fade-in="true" class="ui grid"> <div class="row"> <div class="column padding-reset"> <div class="ui two column huge message page grid"> <div class="row"> <div class="column twelve wide"> <h1 class="ui huge header">Отследи свою купюру!</h1> <p>В каких городах побывала Ваша купюра? Скольким людям она ещё достанется? Быть может новенькая банкнота в Ваших руках только начинает свой путь? Теперь можно не утруждать себя вопросом: "где мои деньги?" Money Way расскажет где побывала и куда направилась ваша купюра. Начните историю своей купюры здесь!</p> </div> <div class="column four wide"> <div class="show-for-large large-3 columns"> <img style="width: 50%" src="images/map.93506a80.png" alt="Map pic"> </div> </div> </div> <div class="row"> <div class="column"> <a ng-click="goToRegister()" class="ui teal button"><i class="add user icon"></i>Регистрация</a> </div> </div> </div> </div> </div> </div> <div class="ui page grid"> <div ngfx-speed="slow" ngfx-fade-in="true" class="one column row"> <div class="column"> <h2 class="ui header"><i class="map outline icon"></i>Отследить без регистрации</h2> <p>Регистрация позволит Вам следить за передвижением своих купюр, получать баллы и участвовать в общем топе. Вы можете отследить купюру и без регистрации, но Ваш рейтинг от этого не изменится. Авторизируйтесь на сайте и экономьте время при поиске купюр.</p> <button class="ui tiny button m-top-10" ng-click="pressLookUp()">Ввести данные »</button> </div> </div> <div ngfx-speed="medium" ngfx-fade-in="true" class="two column row" ng-if="isLookingUp"> <div class="column"> <div class="ui form"> <div class="ui field"> <label>Номер банкноты: <input type="text" ng-model="lookUpCash.cashId" mask="DD 9999999" restrict="reject" required> </label> </div> <div class="ui field"> <label>Номинал банкноты <sm-dropdown class="fluid selection" model="lookUpCash.banknote" items="banknotes" label="item.label" value="item" default-text="\'Банкнота\'"></sm-dropdown> <script>$(document).ready(function () {\n                    $(\'.ui.dropdown\').dropdown();\n                  });</script> </label> </div> <div class="ui field"> <label>Коментарий: <textarea type="text" ng-model="lookUpCash.comment" placeholder="Коментарий"></textarea> </label> </div> <button ng-disabled="!isAddable()" ng-click="lookUp()" style="margin-top: 15px" type="submit" class="ui teal button"><i class="search icon"></i>Найти </button> </div> </div> <div class="column"> <div class="ui form"> <div class="ui field"> <label>Адрес: {{lookUpCash.address}} </label> <ng-map style="margin-top: 20px" id="lookup"></ng-map> </div> </div> </div> </div> <div ngfx-speed="slow" ng-if="isLookedUp" ngfx-fade-in="isLookedUp" ngfx-fade-out-left="!isLookedUp" class="ui divider fade"></div> <div ngfx-speed="slow" ng-if="isLookedUp" ngfx-fade-in="isLookedUp" ngfx-fade-out-left="!isLookedUp" class="one column row fade"> <div class="column"> <table class="ui very basic table"> <thead> <tr> <th>Тип банкноты</th> <th>Номер банкноты</th> <th>Дата регистрации</th> <th>Регион</th> <th>Пользователь</th> <th>Коментарий</th> </tr> </thead> <tbody> <tr ng-repeat="cash in cashArray"> <td> <div ng-bind-html="cash.banknote.label"></div> ({{cash.banknote.banknoteType.code}}) </td> <td>{{cash.cashId}}</td> <td>{{getTime(cash.datetime)}}</td> <td>{{cash.address}}</td> <td>{{cash.user?cash.user.username:""}}</td> <td>{{cash.comment}}</td> </tr> </tbody> </table> </div> </div> </div> </div> <div ngfx-speed="slow" ngfx-fade-in="true" ng-if="isAuthenticated()" class="ui page grid"> <div class="row margin-top-20" style="margin-left: 40px"> <h3 class="ui header">Мои купюры</h3> </div> <div ngfx-speed="slow" ngfx-fade-in="true" class="one column row fade"> <div class="column"> <table class="ui unstackable selectable striped table"> <thead> <tr> <th>Тип банкноты</th> <th>Номер банкноты</th> <th>Дата регистрации</th> <th>Регион</th> <th>Кол-во регистраций</th> <th>Коментарий</th> </tr> </thead> <tbody> <tr ng-repeat="cash in myCash" ng-click="goToCashPage(cash)"> <td> <div ng-bind-html="cash.banknote.label"></div> ({{cash.banknote.banknoteType.code}}) </td> <td>{{cash.cashId}}</td> <td>{{getTime(cash.datetime)}}</td> <td>{{cash.address}}</td> <td>{{cash.countOfEntries}}</td> <td>{{cash.comment}}</td> </tr> </tbody> </table> <div style="margin-left: 40px" ng-if="myCash.length == 0" class="row"> <h5>Нeт ни одной купюры</h5> </div> </div> <div class="ui two column grid"> <div ng-if="myCash.length > 0" class="two column row"> <div class="column"> <h4>Всего моих купюр: {{myCash.length}}</h4> </div> <div class="column"> <h4>На сумму: {{moneyCount}} руб.</h4> </div> </div> </div> </div> <div class="one column row"> <div class="column"> <button ng-click="addingModal()" style="margin-top: 15px" type="submit" class="ui teal button floated-right"> <i class="add icon"></i>Добавить </button> </div> </div> </div> <div class="ui divider"></div> <div class="ui page grid"> <div ngfx-speed="slow" ngfx-fade-in="true" class="ui page grid"> <div class="two column row"> <div style="text-align: center" class="column"> <h4>Всего зарегистрировано купюр: {{countOfBanknotes.count}}</h4> </div> <div style="text-align: center" class="column"> <h4>На сумму: {{summ.count}} руб.</h4> </div> </div> <br> <div class="three column row"> <div class="column"> <h2 class="ui header">Топ 5 юзеров</h2> <table class="ui celled red table"> <thead> <th>#</th> <th>Имя</th> </thead> <tr ng-repeat="user in statsUsers"> <td>{{$index+1}}</td> <td>{{user[0]}}</td> </tr> </table> </div> <div class="column"> <h2 class="ui header">Топ 5 городов</h2> <table class="ui green celled table"> <thead> <th>#</th> <th>Название</th> </thead> <tr ng-repeat="loc in statsLocalities"> <td>{{$index+1}}</td> <td>{{loc[0]}}</td> </tr> </table> </div> <div class="column"> <h2 class="ui header">Топ 5 купюр</h2> <table class="ui blue celled table"> <thead> <th>#</th> <th>Номер</th> </thead> <tr ng-repeat="record in statsRecords"> <td>{{$index+1}}</td> <td>{{record[0]}}</td> </tr> </table> </div> </div> <div class="ui divider"></div> </div> </div> </div>'),a.put("views/mainlayout/footer.html",'<div class="ui inverted vertical footer segment"> <div class="ui center aligned container"> <img src="/images/map_icon.042e428f.png" class="ui centered mini image"> <div class="ui horizontal inverted small divided link list"> <!--      <a class="item" href="#">Site Map</a>--> <!--  <a class="item" href="#">Contact Us</a>--> <!--      <a class="item" href="#">Terms and Conditions</a>--> <a class="item" href="#">©Desingned and developed by Alexey Kalina</a> </div> </div> </div>'),a.put("views/mainlayout/header.html",'<div class="ui large inverted menu"> <a class="item"> <img class="logo" style="margin-right: 20px" src="/images/map_icon.042e428f.png"> </a> <a style="margin-left: 2%" ng-click="goToMain()" class="item"> <!-- <img class="logo" style="margin-right: 20px" src="/images/map_icon.042e428f.png">--> <h2><i class="home teal icon"></i></h2> </a> <!-- <a class="item">\n     О проекте\n   </a>\n   <a class="item">\n     Новости\n   </a>--> <div id="custom-error-notification"> <div> <div class="header"> Ошибка </div> <p> </p> </div> </div> <div id="custom-success-notification"> <div> <div class="header"> Успех </div> <p> </p> </div> </div> <div class="ui small modal supersmall login"> <i class="close icon"></i> <div class="header">Авторизация</div> <div class="content"> <form class="ui form one column grid left-login-fix" id="login_form"> <div class="row"> <div class="two column field"> <label>Логин/Email</label> <input ng-model="loginData.credintial" type="text" name="login" placeholder="Логин/Email" required> </div> </div> <div class="row"> <div class="two column field row"> <label>Пароль</label> <input ng-model="loginData.password" type="password" placeholder="Пароль" required> </div> </div> </form> </div> <div class="actions"> <div ng-click="login()" class="ui positive right labeled icon button" type="submit"> Вход <i class="checkmark icon"></i> </div> </div> </div> <div class="right menu"> <a class="ui item" ng-if="!isAuthenticated()"> <div ng-click="goToRegister()" class="ui button">Регистрация</div> </a> <a class="ui item" ng-if="!isAuthenticated()"> <div ng-click="loginModal()" class="ui teal button">Вход</div> </a> <a class="ui item" ng-if="isAuthenticated()"> {{user.username}} </a> <a class="ui item" ng-if="isAuthenticated()"> <div ng-click="logout()" class="ui button">Выход</div> </a> </div> </div>'),a.put("views/newcash.html",'<div ng-controller="NewCashCtrl"> <header ngfx-speed="slow" ngfx-fade-in="true" id="bg-yaroslavl" style="background-image: url(\'../images/back.44e443c6.png\')"> <div class="row"> <div class="medium-9 large-8 columns"></div> </div> </header> <div class="ui grid page" style="margin-top: 30px; margin-bottom: 30px"> <button class="ui left labeled icon button" ng-click="goToMain()"> <i class="left arrow icon"></i> Мои купюры </button> <div class="one column row"> <div class="column centered"> <h3>Добавление купюры</h3> </div> </div> <div ngfx-speed="medium" ngfx-fade-in="true" class="two column row"> <div class="column"> <div class="ui form"> <div class="ui field"> <label>Номер банкноты: <input type="text" ng-model="lookUpCash.cashId" mask="DD 9999999" restrict="reject" required> </label> </div> <div class="ui field"> <label>Номинал банкноты <sm-dropdown ng-if="banknotesLoaded" class="fluid selection" model="lookUpCash.banknote" items="banknotes" label="item.label" value="item" default-text="\'Банкнота\'"></sm-dropdown> <script>$(document).ready(function () {\n                  $(\'.ui.dropdown\').dropdown();\n                });</script> </label> </div> <div class="ui field"> <label>Коментарий: <textarea type="text" ng-model="lookUpCash.comment" placeholder="Коментарий"></textarea> </label> </div> <button ng-disabled="!isAddable()" ng-click="add()" style="margin-top: 15px" type="submit" class="ui teal button"><i class="plus icon"></i>Добавить </button> </div> </div> <div class="column"> <div class="ui form"> <div class="ui field"> <label>Адрес: {{lookUpCash.address}} </label> <ng-map style="margin-top: 20px" id="lookup"></ng-map> </div> </div> </div> </div> </div> </div>'),a.put("views/register.html",'<div style="margin-top: 30px; margin-bottom: 30px" class="ui grid container centered"> <div ng-if="!sended" class="ui segment left aligned"> <div ngfx-speed="slow" ngfx-fade-in="true" style="margin-bottom: 20px; text-align: center" class="row container"> <h5>Регистрация</h5> </div> <form ngfx-speed="slow" ngfx-fade-in="true" class="ui form column"> <div class="field"> <label>Логин</label> <input type="text" ng-model="registerData.username" ng-blur="checkLogin();checkLoginDirty() " name="login" placeholder="Логин" required> </div> <div ng-if="!loginValid" class="ui negative message"> <p>Такой логин уже зарегистрирован в системе </p> </div> <div ng-if="!loginNotDirty" class="ui negative message"> <p>Длинна должна быть не менее 6 символов, <br> можно использовать только цифры и буквы </p> </div> <div class="field"> <label>Email</label> <input type="email" ng-model="registerData.email" ng-blur="checkEmail();checkEmailDirty()" name="email" placeholder="Email" required> </div> <div ng-if="!emailNotDirty" class="ui negative message"> <p>Неправильный адрес электронной почты </p> </div> <div ng-if="!emailValid" class="ui negative message"> <p>Такой email уже зарегистрирован в системе </p> </div> <div class="field"> <label>Пароль</label> <input ng-blur="isPasswordDismatch();checkPassDirty()" type="password" ng-model="registerData.password" name="password" placeholder="Пароль" required> </div> <div class="field"> <label>Повторите пароль</label> <input ng-blur="isPasswordDismatch();checkPassDirty()" type="password" ng-model="accessory.repPassword" name="repPassword" placeholder="Повторите пароль" required> </div> <div ng-if="!passwordValid" class="ui negative message"> <p>Пароли не совпадают </p> </div> <div ng-if="!passwordNotDirty" class="ui negative message"> <p>Мин. длинна пароля - 6 симовлов </p> </div> <div class="field"> <div class="ui checkbox"> <input type="checkbox" ng-model="accessory.dontAsshole" tabindex="0" class=""> <label>Я не буду безобразничать и согласен быть паинькой.</label> </div> </div> <div class="ui grid centered vertically padded"> <button ng-click="clickRegister()" class="ui button teal" ng-disabled="isRegisterBtnDisabled()" type="submit"><i class="add user icon"></i>Зарегистрироваться </button> </div> </form> </div> <div ngfx-speed="slow" ngfx-fade-in="true" ng-if="foundUserUnconfirmed" class="ui grid container"> <div> <h5> В системе уже есть запись с таким логином/email<br> Выслать письмо-подтверждение повторно?</h5> <button ng-click="clickResend()" class="ui button teal" ng-disabled="isRegisterBtnDisabled()" type="submit"><i class="add user icon"></i>Переотправить </button> </div> </div> <div ngfx-speed="slow" ngfx-fade-in="true" ng-if="allOk" class="ui grid container"> <div> <h5>Письмо с потверждением выслано на указанный адрес электронной почты. Если письмо не приходит, проверьте в папке со спамом</h5> </div> </div> </div>');
}]);